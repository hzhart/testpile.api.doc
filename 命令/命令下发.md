# 命令下发

> 更新记录

<table>
    <tr>
        <th style="width:250px;">日期</th>
        <th>更新内容</th>
    </tr>
    <tr>
        <td>2018-06-04 10:53:38</td>
        <td>生成时间</td>
    </tr>
</table>

> 字段

<table>
    <tr>
        <th style="width:150px;">属性名称</th>
        <th style="width:60px;">类型</th>
        <th style="width:60px;">必填</th>
        <th style="width:200px;">说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>id</td>
        <td>long</td>
        <td>-</td>
        <td></td>
        <td>-</td>
    </tr>
    <tr>
        <td>deviceId</td>
        <td>string</td>
        <td>-</td>
        <td>设备ID</td>
        <td>-</td>
    </tr>
    <tr>
        <td>iotDeviceId</td>
        <td>string</td>
        <td>-</td>
        <td>物联网平台ID</td>
        <td>-</td>
    </tr>
    <tr>
        <td>deviceType</td>
        <td>int</td>
        <td>-</td>
        <td>设备类型</td>
        <td>7: 阴极保护测试桩</td>
    </tr>
    <tr>
        <td>area</td>
        <td>string</td>
        <td>-</td>
        <td>区域</td>
        <td>-</td>
    </tr>
    <tr>
        <td>commNo</td>
        <td>string</td>
        <td>-</td>
        <td>通讯号</td>
        <td>-</td>
    </tr>
    <tr>
        <td>funCode</td>
        <td>int</td>
        <td>-</td>
        <td>命令类型</td>
        <td>见下表</td>
    </tr>
    <tr>
        <td>data</td>
        <td>object</td>
        <td>-</td>
        <td>数据</td>
        <td>见下表</td>
    </tr>
    <tr>
        <td>sentAt</td>
        <td>int</td>
        <td>-</td>
        <td>发送时间</td>
        <td>-</td>
    </tr>
    <tr>
        <td>timeoutAt</td>
        <td>int</td>
        <td>-</td>
        <td>过期时间</td>
        <td>-</td>
    </tr>
    <tr>
        <td>remark</td>
        <td>string</td>
        <td>-</td>
        <td>备注</td>
        <td>-</td>
    </tr>    
    <tr>
        <td>companyId</td>
        <td>int</td>
        <td>-</td>
        <td>所属公司</td>
        <td>-</td>
    </tr>    
    <tr>
        <td>status</td>
        <td>tinyint</td>
        <td>-</td>
        <td>状态</td>
        <td>见全局状态</td>
    </tr>
    <tr>
        <td>reply</td>
        <td>object</td>
        <td>-</td>
        <td>设备命令回复</td>
        <td>见下表</td>
    </tr>
    <tr>
        <td>serialNo</td>
        <td>string</td>
        <td>-</td>
        <td>序列号</td>
        <td>-</td>
    </tr>
    <tr>
        <td>batchNo</td>
        <td>string</td>
        <td>-</td>
        <td>下发批次号</td>
        <td>-</td>
    </tr>
    <tr>
        <td>sendCount</td>
        <td>string</td>
        <td>-</td>
        <td>下发次数</td>
        <td>-</td>
    </tr>
    <tr>
        <td>createdAt</td>
        <td>datetime</td>
        <td>-</td>
        <td>创建时间</td>
        <td>-</td>
    </tr>
    <tr>
        <td>failureReason</td>
        <td>string</td>
        <td>-</td>
        <td>下发次数</td>
        <td>-</td>
    </tr>
    <tr>
        <td>logList</td>
        <td>array</td>
        <td>-</td>
        <td>下发记录列表</td>
        <td>-</td>
    </tr>
</table>

## 命令列表

```
GET /admin/command/v1/command
```

> 请求参数:

<table>
    <tr>
        <th style="width:150px;">属性名称</th>
        <th style="width:60px;">类型</th>
        <th style="width:60px;">必填</th>
        <th style="width:200px;">说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>area</td>
        <td>string</td>
        <td>-</td>
        <td>区域</td>
        <td>-</td>
    </tr>
    <tr>
        <td>stationId</td>
        <td>string</td>
        <td>-</td>
        <td>站点ID列表, 逗号分隔</td>
        <td>-</td>
    </tr>
</table>


## 命令下发

```
POST /admin/command/v1/command
```

> 参数:

<table>
    <tr>
        <th style="width:150px;">属性名称</th>
        <th style="width:60px;">类型</th>
        <th style="width:60px;">必填</th>
        <th style="width:200px;">说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>commNos</td>
        <td>array</td>
        <td>是</td>
        <td>要下发的设备通讯号, 以数组方式传递</td>
        <td>-</td>
    </tr>
    <tr>
        <td>funCode</td>
        <td>int</td>
        <td>是</td>
        <td>命令类型</td>
        <td>见下表</td>
    </tr>
    <tr>
        <td>data</td>
        <td>object</td>
        <td>是</td>
        <td>下发的数据</td>
        <td>见下表</td>
    </tr>
    <tr>
        <td>duration</td>
        <td>int</td>
        <td>-</td>
        <td>命令超时时间,单位:分钟</td>
        <td>默认: 1440, 即24小时</td>
    </tr>
</table>


## 璟恩 v1.1 命令类型 与 数据

<table>
    <tr>
        <th style="width:250px;">设置项名称</th>
        <th style="width:60px;">funCode</th>
        <th style="width:200px;">数据</th>
        <th style="width:200px;">说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>4.2 读通电保护电位</td>
        <td>0x02</td>
        <td>-</td>
        <td>4.2 读通电保护电位</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.3 读管道断路电位</td>
        <td>0x03</td>
        <td>-</td>
        <td>4.3 读管道断路电位</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.4 读管道自然电位</td>
        <td>0x04</td>
        <td>-</td>
        <td>4.4 读管道自然电位</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.5 读管地交流电位</td>
        <td>0x05</td>
        <td>-</td>
        <td>4.5 读管地交流电位</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.6 读管地电流密度</td>
        <td>0x06</td>
        <td>-</td>
        <td>4.6 读管地电流密度</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.7 读阳极输出电流</td>
        <td>0x07</td>
        <td>-</td>
        <td>4.7 读阳极输出电流</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.8 读阳极开路电位</td>
        <td>0x08</td>
        <td>-</td>
        <td>4.8 读阳极开路电位</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.9 读恒电位仪参数</td>
        <td>0x09</td>
        <td>-</td>
        <td>4.9 读恒电位仪参数</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.11 读模组信息</td>
        <td>0x0B</td>
        <td>-</td>
        <td>4.11 读模组信息</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.13 设置上报周期和冻结周期</td>
        <td>0x0D</td>
        <td>{uploadType: 上报方式, uploadPeroid: 周期值, uploadTime: 上传时间, freezeType: 冻结方式, freezePeroid: 冻结周期值, freezeTime: 冻结时间}</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.14 查询上报周期和冻结周期</td>
        <td>0x0E</td>
        <td>-</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.15 设置信号采集间隔</td>
        <td>0x0F</td>
        <td>{"unit":单位,"interval":采集间隔}</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.16 查询信号采集间隔</td>
        <td>0x10</td>
        <td>-</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.17 设置 IP 地址</td>
        <td>0x11</td>
        <td>{"ip":"IP","port":端口}</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
</table>

## 功尊 v1.3 命令类型 与 数据

<table>
    <tr>
        <th style="width:250px;">设置项名称</th>
        <th style="width:60px;">funCode</th>
        <th style="width:200px;">数据</th>
        <th style="width:200px;">说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>4.11 读模组信息</td>
        <td>0x0B</td>
        <td>-</td>
        <td>4.11 读模组信息</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.13 设置上报周期和冻结周期</td>
        <td>0x0D</td>
        <td>{uploadType: 上报方式, uploadPeroid: 周期值, uploadTime: 上传时间, freezeType: 冻结方式, freezePeroid: 冻结周期值, freezeTime: 冻结时间}</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.14 查询上报周期和冻结周期</td>
        <td>0x0E</td>
        <td>-</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.15 设置信号采集间隔</td>
        <td>0x0F</td>
        <td>{"unit":单位,"interval":采集间隔}</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.16 查询信号采集间隔</td>
        <td>0x10</td>
        <td>-</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.17 设置 IP 地址</td>
        <td>0x11</td>
        <td>{"ip":"IP","port":端口}</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.14 设置密钥 0x13</td>
        <td>0x13</td>
        <td>{"version":版本号,"key":"密钥, 16hex"}</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.16、读地理信息 0x15</td>
        <td>0x15</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.17、设置通信号 0x16</td>
        <td>0x16</td>
        <td>{"commNo":"通讯号"}</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.18、读记录数据 0x17</td>
        <td>0x17</td>
        <td>{"startDateTime":"开始日期时间","endDateTime":"结束日期时间"}</td>
        <td>见原协议</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.19、设置报警参数 0x18</td>
        <td>0x18</td>
        <td>{"category":"数据类型","upperLimit":"上限报警值","lowerLimit":"下限报警值"}</td>
        <td>见原协议</td>
        <td>数据类型说明:1-通电电位，2-断电电位，3-自然电位，4-交流电压，5-交流电流， 6-直流电流，7-牺牲阳极输出电流，8-牺牲阳极开路电位</td>
    </tr>
    <tr>
        <td>4.20、启动地理信息定位 0x19</td>
        <td>0x19</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
    </tr>
    <tr>
        <td>4.21、读设备参数 0x20</td>
        <td>0x20</td>
        <td>-</td>
        <td>-</td>
        <td>见下表</td>
    </tr>
    <tr>
        <td>4.21、读报警记录 2 0x22</td>
        <td>0x22</td>
        <td>-</td>
        <td>-</td>
        <td>见下表</td>
    </tr>
</table>

> 设备参数
<table>
    <tr>
        <th style="width:250px;">名称</th>
        <th style="width:200px;">说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>deviceTimestamp</td>
        <td>设备时间戳</td>
        <td>-</td>
    </tr>
    <tr>
        <td>deviceStatus</td>
        <td>设备状态</td>
        <td>见下表</td>
    </tr>
    <tr>
        <td>ICCID</td>
        <td>ICCID</td>
        <td>-</td>
    </tr>
    <tr>
        <td>voltage</td>
        <td>电池电压</td>
        <td>-</td>
    </tr>
    <tr>
        <td>batteryPercent</td>
        <td>电池电量百分比</td>
        <td>-</td>
    </tr>
    <tr>
        <td>ppValue</td>
        <td>通电电位</td>
        <td>-</td>
    </tr>
    <tr>
        <td>cpValue</td>
        <td>断电电位</td>
        <td>-</td>
    </tr>
    <tr>
        <td>npValue</td>
        <td>自然电位</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aopValue</td>
        <td>阳极开路电位</td>
        <td>-</td>
    </tr>
    <tr>
        <td>apValue</td>
        <td>交流电压</td>
        <td>-</td>
    </tr>
    <tr>
        <td>acValue</td>
        <td>交流电流</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aocValue</td>
        <td>阳极输出电流</td>
        <td>-</td>
    </tr>
    <tr>
        <td>dcValue</td>
        <td>直流电流</td>
        <td>-</td>
    </tr>
    <tr>
        <td>reportType</td>
        <td>上报方式</td>
        <td>0:定时按天上传，表示每隔多少天上传 1:表示定时按月上传，如每月 1 日或 2 日 3:表示按小时传，如每隔 2 小时上传 1 次 4:表示按分钟上传，如每隔 10 分钟上传</td>
    </tr>
    <tr>
        <td>reportPeriod</td>
        <td>上报周期</td>
        <td>设置按天传，表示几天传 1 次，设置月，表示每月 的几号上传，设置 3 或 4 表示间隔值</td>
    </tr>
    <tr>
        <td>reportTime</td>
        <td>上传时间</td>
        <td>-</td>
    </tr>
    <tr>
        <td>freezeType</td>
        <td>冻结方式</td>
        <td>和上报方式一致</td>
    </tr>
    <tr>
        <td>freezePeriod</td>
        <td>冻结周期</td>
        <td>和上报周期一致</td>
    </tr>
    <tr>
        <td>freezeTime</td>
        <td>冻结时间</td>
        <td>和上报时间一致</td>
    </tr>
    <tr>
        <td>ip</td>
        <td>IP地址</td>
        <td>-</td>
    </tr>
    <tr>
        <td>port</td>
        <td>端口号</td>
        <td>-</td>
    </tr>
    <tr>
        <td>signalInterval</td>
        <td>信号采集间隔</td>
        <td>-</td>
    </tr>
    <tr>
        <td>signalIntervalUnit</td>
        <td>信号采集间隔单位</td>
        <td>0:分钟 1:小时 2:秒</td>
    </tr>
    <tr>
        <td>latitude</td>
        <td>纬度</td>
        <td>-</td>
    </tr>
    <tr>
        <td>N/S</td>
        <td>北/南</td>
        <td>-</td>
    </tr>
    <tr>
        <td>longitude</td>
        <td>经度</td>
        <td>-</td>
    </tr>
    <tr>
        <td>E/W</td>
        <td>东/西</td>
        <td>-</td>
    </tr>
    <tr>
        <td>ppAlertValueUpper</td>
        <td>通电电位上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>ppAlertValueLower</td>
        <td>通电电位上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>cpAlertValueUpper</td>
        <td>断电电位上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>cpAlertValueLower</td>
        <td>断电电位上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>npAlertValueUpper</td>
        <td>自然电位上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>npAlertValueLower</td>
        <td>自然电位上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>apAlertValueUpper</td>
        <td>交流电压上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>apAlertValueLower</td>
        <td>交流电压下限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>acAlertValueUpper</td>
        <td>交流电流上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>acAlertValueLower</td>
        <td>交流电流下限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>dcAlertValueUpper</td>
        <td>直流电流上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>dcAlertValueLower</td>
        <td>直流电流下限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aocAlertValueUpper</td>
        <td>牺牲阳极输出电流上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aocAlertValueLower</td>
        <td>牺牲阳极输出电流下限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aopAlertValueUpper</td>
        <td>牺牲阳极开路电位上限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aopAlertValueLower</td>
        <td>牺牲阳极开路电位下限报警值</td>
        <td>-</td>
    </tr>
    <tr>
        <td>alertStatus</td>
        <td>报警状态</td>
        <td>见下表</td>
    </tr>
</table>

> 设备状态
<table>
    <tr>
        <th style="width:250px;">名称</th>
        <th style="width:200px;">说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>batteryLow</td>
        <td>电池电压低</td>
        <td>-</td>
    </tr>
</table>

> 报警状态
<table>
    <tr>
        <th style="width:250px;">名称</th>
        <th style="width:200px;">说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>ppValueUpperAlert</td>
        <td>通电电位上限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>ppValueLowerAlert</td>
        <td>通电电位下限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>cpValueUpperAlert</td>
        <td>断电电位上限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>cpValueLowerAlert</td>
        <td>断电电位下限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>npValueUpperAlert</td>
        <td>自然电位上限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>npValueLowerAlert</td>
        <td>自然电位下限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>apValueUpperAlert</td>
        <td>交流电压上限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>apValueLowerAlert</td>
        <td>交流电压下限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>acValueUpperAlert</td>
        <td>交流电流上限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>acValueLowerAlert</td>
        <td>交流电流下限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>dcValueUpperAlert</td>
        <td>直流电流上限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>dcValueLowerAlert</td>
        <td>直流电流下限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aocValueUpperAlert</td>
        <td>牺牲阳极输出电流上限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aocValueLowerAlert</td>
        <td>牺牲阳极输出电流下限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aopValueUpperAlert</td>
        <td>牺牲阳极开路电位上限报警</td>
        <td>-</td>
    </tr>
    <tr>
        <td>aopValueLowerAlert</td>
        <td>牺牲阳极开路电位下限报警</td>
        <td>-</td>
    </tr>
</table>

## 命令取消

```
POST /admin/command/v1/command/cancel
```

> 请求参数

<table>
    <tr>
        <th style="width:150px;">属性名称</th>
        <th style="width:60px;">类型</th>
        <th style="width:60px;">必填</th>
        <th style="width:200px;">说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>commandIds</td>
        <td>array</td>
        <td>是</td>
        <td>命令ID数组</td>
        <td>如: [1,2,3]</td>
    </tr>
</table>